# local-connectivity-structure
Tutorial and demonstration using spectral bipartivity to identify the local connectivity structure of a simple network. Methodological repository accompanying:

## Identifying local connectivity structure

Here we propose that spectral bipartivity can be re-purposed to identify local connectivity structure in networks using a comparison to random expectation. Specifically, we use this measure to quantify the relative over-representation of squares vs. triangles in the local connectivity structure of a network. Random networks give us the baseline for values of spectral bipartivity. Social networks have lots of triangles and so are _less_ bipartite than random expectation. Functional networks have lots of squares and so are _more_ bipartite than random expectation. Two-mode networks are bipartite and would have a value of 1. Below is a toy example of how social, random, functional, and two-mode networks with the same number of nodes and edges are arranged according to their value of spectral bipartivity. More detail on local connectivity types and spectral bipartivity below, and in the paper. 

![A toy example of how social, random, functional, and two-mode networks with seven nodes and eleven edges show increasing spectral bipartivity.](scale.jpg?raw=true)

In less contrived scenarios, the comparison to random expectation is key to identifying local connectivity structure because spectral bipartivity is defined as a ratio and the denominator of this ratio is strongly affected by the number of edges in the network. Randomization preserves the number of edges (and the degree sequence) so it serves as a way to “center” the scale such that remaining differences reflect local connectivity structure. Developing new measures that would allow for comparison across networks substantially different in size is a promising area for future work in network science.

### Degree-preserving randomization

We use a version of this called random pairwise rewiring, wherein pairs of edges are selected and an end point of each edge are swapped (see: Hanhijarvi et al., 2009, Figure 1(a)). Our implementation also guarantees that the randomized network remains simple by following through with a rewire only so long as it will not introduce self-loops or multi-edges. Randomization continues until 10·m pairs of links have been rewired, where m is the number of simple edges.

### Statistical testing

The KS test is nice, but plots are usually nicest. 

## Local connectivity types
Networks can be categorized into typologies wherein different network types have systematically different structural properties. Since network measures tend to be correlated and local network features affect global ones, we consider a network typology based in recognizably distinct local connectivity structures. Random networks, social networks, and two-mode networks are the most important and well-known connectivity types (Newman et al., 2001; Rivera et al., 2010; Borgatti and Everett, 1997). These form the basis for our typology. Recently, a new network type with a distinctive local connectivity structure has been identified in work on protein-protein interaction (PPI) networks (Kovács et al., 2019; Kitsak, 2020). This adds so-called functional networks to our typology.

### Random networks
Random networks are those where the set of existing links might have come to occur by chance. Several celebrated network properties, such as the emergence of a giant component and the small world property, are identifiable already in random networks (Bollobás, 2001; Newman et al., 2001). Other common network properties, such as the existence of hubs or communities, can be introduced using block-wise random networks (Holland et al., 1983; Newman et al., 2001; Karrer and Newman, 2011). This flexibility makes random networks especially useful as a baseline comparison for empirical network data and generative network models (Costa et al., 2007). Some measures, such as modularity (Newman, 2006) and degree assortativity (Pastor-Satorras et al., 2001; Newman, 2003a), directly incorporate a comparison to random expectation.

### Two-mode networks
Two-mode  networks  are  those  where  the  links  are  affiliations  between categorically different nodes. For instance, directors are affiliated with the corporate boards on which they serve (Mizruchi, 1996; Seierstad and Opsahl, 2011; Takes and Heemskerk, 2016; Valeeva et al., 2020). Two-mode networks are bipartite in that the nodes can be separated into two groups where links exist between, but not within, groups (Borgatti and Everett, 1997; Holme et al., 2003). This is a hard constraint on the existence of network links that affects the interpretation of any network-structural property. As such, there are specific network analysis techniques and particular versions of centrality, modularity, closure, and other measures developed for two-mode networks (Borgatti and Everett, 1997; Zhou et al., 2007; Barber,2007; Opsahl, 2013; Berardo, 2014).

### Social networks
Social networks are those where links exist between nodes who associate with one another in some sense. This is a soft constraint on the formation of links that affects many network properties. Social networks have high clustering as various social dynamics are known to generate triadic closure (see: Rivera et al., 2010). They are typically shaped by homophily leading to high assortativity, where nodes who associate with one another tend to be similar in some sense (McPherson et al., 2001; Newman, 2003a). Social networks frequently contain interpretable communities (Davis et al., 2009; Blondelet al., 2008) and are often assortative in degree (Johnson et al., 2010). It has been suggested that the tendency of nodes to form communities may be a derivative feature of triadic closure operating locally (Jamakovicet al., 2015; Colomer-de Simón et al., 2013). The over-representation of triangles also allows link prediction algorithms that operate on a two-step basis (L2) to perform well on social networks (Ghasemian et al., 2020). Degree assortativity may also be related to triadic closure, homoplily, and community structure (Newman and Park, 2003; Asikainen et al., 2020).

### Functional networks
Functional networks are those where links form between nodes that complement one another in fulfilling some function. This network type has been identified in work on protein-protein interaction (PPI) networks; proteins bind not with similar others but with those that have a binding site physically compatible with their own (Kovács et al., 2019). These networks are shaped by the principle of complementarity, a different soft constraint that likely also affects many, related, network properties (Kitsak, 2020). Kovács et al. (2019) establishes that L2 heuristics under-perform in link prediction on PPI networks while those operating on a three-step basis (L3) are more accurate. In analogy with social networks, this might suggest that functional dynamics generate tetradic closure (see: Fujiwara and Aoyama, 2010). Meso-scale structures in PPI networks have been termed functional modules as they are often interpretable as key to some higher-level cellular function (Barabási and Oltvai, 2004; Chen and Yuan, 2006; Ghiassian et al., 2015). Disassortativity in degree is an expected property of functional networks more broadly (Barabási and Pósfai, 2016; Johnson et al., 2010; Fujiwara and Aoyama, 2010). Food webs and company-level production networks have been proposed as additional domains where the same structural patterns are likely to be found (Kitsak, 2020; Mattsson et al., 2021).

## Spectral bipartivity

Spectral methods can be used to summarize the local connectivity structure of a network. The Estrada index is an absolute measure of local connectivity, it quantifies the local density of cycles by having closed paths contribute progressively less to the value of the measure as they take more steps to complete (Estrada, 2000). Its value can be computed as the trace of the matrix exponential of a network's adjacency matrix (alternatively, this is also the sum of the exponential of the eigenvalues of that adjacency matrix).

More relevant to local connectivity structure is a variation of the Estrada index that separates the contribution of even and odd closed paths: spectral bipartivity. This is done using the hyperbolic sine and cosine matrix functions, which add up to the matrix exponential, as applied to a network's adjacency matrix. With proper normalization, spectral bipartivity ranges from 0 when the network is fully complete to 1 when the network is fully bipartite (Estrada and Rodríguez-Velázquez, 2005; Estrada, 2006; Estrada and Gómez-Gardeñes, 2016). We primarily consider the value of the spectral bipartivity under a logistic transformation, because this metric is restricted in range from 0 to 1 and the Estrada index in the denominator can become quite large. Indeed, it grows exponentially with the square root of the number of edges in certain cases (de la Peña et al., 2007). Crucially for large networks, the logit spectral bipartivity can be readily approximated when the spectral bipartivity is very small and the largest and smallest eigenvalues of a network's adjacency matrix are substantially bigger (in magnitude) than their respective neighboring eigenvalues. In this case the logit spectral bipartivity is the sum of the largest and smallest eigenvalues, negated. See the paper for this derivation, if you'd like. 
